<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>Student Dashboard | KidsDev Academy</title>
  <meta name="description" content="Manage your coding journey. Track progress, resume courses, and view achievements on KidsDev Academy.">
  <meta name="robots" content="noindex, nofollow"> <meta name="author" content="Tolani Agbeyangi">
  
  <meta property="og:title" content="KidsDev Student Portal">
  <meta property="og:image" content="image/logo.png">
  <meta property="og:type" content="website">

  <link rel="icon" type="image/png" href="image/logo.png">

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest"></script>
  <link rel="stylesheet" href="css/style.css">
  
  <style>
    /* Smooth Fade In */
    body { opacity: 0; transition: opacity 0.5s ease-in-out; background-color: #F8FAFC; color: #0F172A; }
    body.loaded { opacity: 1; }
    
    /* Dashboard Specific Styles */
    .dash-card { background: white; border: 1px solid #E2E8F0; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); transition: transform 0.2s; }
    .dash-card:hover { transform: translateY(-2px); border-color: #cbd5e1; }
    
    .dash-nav-link { color: #64748B; transition: all 0.2s; border-radius: 12px; }
    .dash-nav-link:hover { background-color: #F1F5F9; color: #0F172A; }
    .dash-nav-link.active { background-color: #FFF7ED; color: #F97316; font-weight: 600; border: 1px solid #FFEDD5; }
    .dash-nav-link.active i { color: #F97316; }
  </style>
</head>

<body class="font-[Poppins] flex h-screen overflow-hidden">

  <aside class="hidden md:flex flex-col w-64 bg-white border-r border-slate-200 h-full shadow-sm z-20">
    <div class="p-6 flex items-center gap-3">
      <a href="index.html" class="flex items-center gap-2">
        <img src="image/logo.png" alt="Logo" class="h-9 w-auto">
        <span class="font-extrabold text-xl tracking-tight text-[#0F172A]">Kids<span class="text-[#F97316]">Dev</span></span>
      </a>
    </div>

    <nav class="flex-1 px-4 space-y-2 mt-4">
      <a href="#" class="dash-nav-link active flex items-center gap-3 px-4 py-3">
        <i data-lucide="layout-dashboard" class="w-5 h-5"></i> Dashboard
      </a>
      <a href="courses.html" class="dash-nav-link flex items-center gap-3 px-4 py-3">
        <i data-lucide="book-open" class="w-5 h-5"></i> Course Catalog
      </a>
      <a href="challenges.html" class="dash-nav-link flex items-center gap-3 px-4 py-3">
        <i data-lucide="trophy" class="w-5 h-5"></i> Daily Challenges
      </a>
      <a href="profile.html" class="dash-nav-link flex items-center gap-3 px-4 py-3">
        <i data-lucide="user" class="w-5 h-5"></i> My Profile
      </a>
    </nav>
    
    <div class="p-4 border-t border-slate-100">
      <button id="logoutBtn" class="w-full flex items-center gap-3 px-4 py-3 text-red-500 hover:bg-red-50 rounded-xl transition font-medium">
        <i data-lucide="log-out" class="w-5 h-5"></i> Log Out
      </button>
    </div>
  </aside>

  <main class="flex-1 overflow-y-auto relative p-6 md:p-10">
    
    <div class="md:hidden flex items-center justify-between mb-8">
      <div class="flex items-center gap-2">
        <img src="image/logo.png" class="h-8">
        <span class="font-bold text-lg text-[#0F172A]">KidsDev</span>
      </div>
      <button id="mobileLogoutBtn" class="text-red-500 bg-red-50 p-2 rounded-lg"><i data-lucide="log-out" class="w-5 h-5"></i></button>
    </div>

    <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-4">
      <div>
        <h1 class="text-3xl md:text-4xl font-extrabold text-[#0F172A] mb-1">Welcome back, <span id="username" class="text-[#F97316]">Cadet</span>! ðŸ‘‹</h1>
        <p class="text-slate-500 font-medium">Ready to write some code today?</p>
      </div>
      <div class="flex items-center gap-4">
        <div class="bg-white border border-slate-200 px-4 py-2 rounded-full flex items-center gap-2 shadow-sm">
          <span class="w-2.5 h-2.5 bg-green-500 rounded-full animate-pulse"></span>
          <span class="text-xs font-bold text-slate-600 uppercase tracking-wider">Level 1 Novice</span>
        </div>
      </div>
    </header>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
      <div class="dash-card p-6 flex items-center gap-5">
        <div class="w-14 h-14 bg-orange-50 rounded-2xl flex items-center justify-center text-[#F97316]"><i data-lucide="zap" class="w-7 h-7"></i></div>
        <div><p class="text-xs text-slate-400 font-bold uppercase tracking-wider">Total XP</p><h3 class="text-2xl font-extrabold text-[#0F172A]">1,250</h3></div>
      </div>
      <div class="dash-card p-6 flex items-center gap-5">
        <div class="w-14 h-14 bg-blue-50 rounded-2xl flex items-center justify-center text-blue-600"><i data-lucide="book" class="w-7 h-7"></i></div>
        <div><p class="text-xs text-slate-400 font-bold uppercase tracking-wider">Modules Done</p><h3 class="text-2xl font-extrabold text-[#0F172A]">4/15</h3></div>
      </div>
      <div class="dash-card p-6 flex items-center gap-5">
        <div class="w-14 h-14 bg-green-50 rounded-2xl flex items-center justify-center text-green-600"><i data-lucide="flame" class="w-7 h-7"></i></div>
        <div><p class="text-xs text-slate-400 font-bold uppercase tracking-wider">Day Streak</p><h3 class="text-2xl font-extrabold text-[#0F172A]">3 Days</h3></div>
      </div>
    </div>

    <div class="dash-card p-8 mb-10 relative overflow-hidden group border-[#F97316]/20">
      <div class="absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-orange-100 to-transparent rounded-full blur-3xl -z-10 opacity-60 transform translate-x-1/4 -translate-y-1/4"></div>
      <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6 relative z-10">
        <div>
          <span class="inline-block px-3 py-1 rounded-full bg-orange-100 text-[#F97316] text-[10px] font-bold uppercase tracking-wide mb-3">In Progress</span>
          <h2 class="text-2xl font-bold text-[#0F172A] mb-2">Python Masterclass</h2>
          <p class="text-slate-500 max-w-lg text-sm">You left off at <strong class="text-slate-700">Module 4: Variables & Data</strong>. Complete it to unlock the next badge.</p>
          
          <div class="w-full max-w-sm h-2 bg-slate-100 rounded-full mt-4 overflow-hidden">
             <div class="h-full bg-[#F97316] w-[35%] rounded-full"></div>
          </div>
        </div>
        <a href="courses/python/index.html" class="bg-[#0F172A] hover:bg-slate-800 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-slate-200 transition transform hover:-translate-y-1 flex items-center gap-2">
          Resume Learning <i data-lucide="play" class="w-4 h-4 fill-current"></i>
        </a>
      </div>
    </div>

    <h3 class="font-bold text-[#0F172A] text-lg mb-4">Quick Actions</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
       <a href="challenges.html" class="dash-card p-4 flex items-center gap-3 hover:bg-slate-50 transition">
          <div class="p-2 bg-purple-50 rounded-lg text-purple-600"><i data-lucide="trophy" class="w-5 h-5"></i></div>
          <span class="font-bold text-sm text-slate-700">Daily Challenge</span>
          <i data-lucide="arrow-right" class="w-4 h-4 text-slate-300 ml-auto"></i>
       </a>
       <a href="courses.html" class="dash-card p-4 flex items-center gap-3 hover:bg-slate-50 transition">
          <div class="p-2 bg-blue-50 rounded-lg text-blue-600"><i data-lucide="search" class="w-5 h-5"></i></div>
          <span class="font-bold text-sm text-slate-700">Browse New Courses</span>
          <i data-lucide="arrow-right" class="w-4 h-4 text-slate-300 ml-auto"></i>
       </a>
    </div>

  </main>

  <script type="module" src="js/guard.js"></script> 
  
  <script>
    if(window.lucide) lucide.createIcons();
    window.addEventListener('load', () => document.body.classList.add('loaded'));
  </script>

  <script type="module">
    import { auth, db } from "./js/firebase.js";
    import { signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // FETCH USER NAME
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        const docRef = doc(db, "users", user.uid);
        try {
          const docSnap = await getDoc(docRef);
          if (docSnap.exists()) {
             const data = docSnap.data();
             const cleanName = data.name ? data.name.split(" ")[0] : "Cadet";
             document.getElementById('username').innerText = cleanName;
          }
        } catch(e) { console.log("Error loading user data:", e); }
      }
    });

    // LOGOUT FUNCTION
    const handleLogout = async () => {
        try {
            await signOut(auth);
            window.location.href = "login.html";
        } catch (error) {
            alert("Error logging out: " + error.message);
        }
    };

    // Attach Listeners
    document.getElementById('logoutBtn')?.addEventListener('click', handleLogout);
    document.getElementById('mobileLogoutBtn')?.addEventListener('click', handleLogout);
  </script>
</body>
</html>